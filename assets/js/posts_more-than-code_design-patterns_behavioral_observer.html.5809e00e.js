"use strict";(self.webpackChunkmiaoxi_blog=self.webpackChunkmiaoxi_blog||[]).push([[3703],{66262:(s,i)=>{i.A=(s,i)=>{const a=s.__vccOpts||s;for(const[s,n]of i)a[s]=n;return a}},43243:(s,i,a)=>{a.r(i),a.d(i,{comp:()=>d,data:()=>A});var n=a(20641);const l=a.p+"assets/img/observer.d46a50f8.png",e=a.p+"assets/img/observer-comic-1-zh.96d06006.png",t=a.p+"assets/img/solution2-zh.5b2d64c6.png",p=a.p+"assets/img/observer-comic-2-zh.d1b39ea3.png",h=a.p+"assets/img/structure.9b045ec3.png",k=a.p+"assets/img/example.1a8279a1.png",r={},d=(0,a(66262).A)(r,[["render",function(s,i){const a=(0,n.g2)("RouteLink");return(0,n.uX)(),(0,n.CE)("div",null,[i[11]||(i[11]=(0,n.Fv)('<h2 id="意图" tabindex="-1"><a class="header-anchor" href="#意图"><span>意图</span></a></h2><p>观察者模式是一种行为设计模式， 允许你定义一种订阅机制， 可在对象事件发生时通知多个 “观察” 该对象的其他对象。</p><figure><img src="'+l+'" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><h2 id="问题" tabindex="-1"><a class="header-anchor" href="#问题"><span>问题</span></a></h2><p>假如你有两种类型的对象：<code>​顾客</code>和<code>商店</code>。顾客对某个特定品牌的产品非常感兴趣 （例如最新型号的 iPhone 手机）， 而该产品很快将会在商店里出售。</p><p>顾客可以每天来商店看看产品是否到货。 但如果商品尚未到货时， 绝大多数来到商店的顾客都会空手而归。</p><figure><img src="'+e+'" alt="前往商店和发送垃圾邮件" tabindex="0" loading="lazy"><figcaption>前往商店和发送垃圾邮件</figcaption></figure><p>另一方面， 每次新产品到货时， 商店可以向所有顾客发送邮件 （可能会被视为垃圾邮件）。 这样， 部分顾客就无需反复前往商店了， 但也可能会惹恼对新产品没有兴趣的其他顾客。</p><p>我们似乎遇到了一个矛盾： 要么让顾客浪费时间检查产品是否到货， 要么让商店浪费资源去通知没有需求的顾客。</p><h2 id="解决方案" tabindex="-1"><a class="header-anchor" href="#解决方案"><span>解决方案</span></a></h2><p>拥有一些值得关注的状态的对象通常被称为目标， 由于它要将自身的状态改变通知给其他对象， 我们也将其称为发布者 （publisher）。 所有希望关注发布者状态变化的其他对象被称为订阅者 （subscribers）。</p><p>观察者模式建议你为发布者类添加订阅机制， 让每个对象都能订阅或取消订阅发布者事件流。 不要害怕！ 这并不像听上去那么复杂。 实际上， 该机制包括 1） 一个用于存储订阅者对象引用的列表成员变量； 2） 几个用于添加或删除该列表中订阅者的公有方法。</p><figure><img src="data:image/png;base64,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" alt="订阅机制允许对象订阅事件通知。" tabindex="0" loading="lazy"><figcaption>订阅机制允许对象订阅事件通知。</figcaption></figure><p>现在， 无论何时发生了重要的发布者事件， 它都要遍历订阅者并调用其对象的特定通知方法。</p><p>实际应用中可能会有十几个不同的订阅者类跟踪着同一个发布者类的事件， 你不会希望发布者与所有这些类相耦合的。 此外如果他人会使用发布者类， 那么你甚至可能会对其中的一些类一无所知。</p><p>因此， 所有订阅者都必须实现同样的接口， 发布者仅通过该接口与订阅者交互。 接口中必须声明通知方法及其参数， 这样发布者在发出通知时还能传递一些上下文数据。</p><figure><img src="'+t+'" alt="发布者调用订阅者对象中的特定通知方法来通知订阅者。" tabindex="0" loading="lazy"><figcaption>发布者调用订阅者对象中的特定通知方法来通知订阅者。</figcaption></figure><p>如果你的应用中有多个不同类型的发布者， 且希望订阅者可兼容所有发布者， 那么你甚至可以进一步让所有发布者遵循同样的接口。 该接口仅需描述几个订阅方法即可。 这样订阅者就能在不与具体发布者类耦合的情况下通过接口观察发布者的状态。</p><h2 id="真实世界类比" tabindex="-1"><a class="header-anchor" href="#真实世界类比"><span>真实世界类比</span></a></h2><figure><img src="'+p+'" alt="杂志和报纸订阅。" tabindex="0" loading="lazy"><figcaption>杂志和报纸订阅。</figcaption></figure><p>如果你订阅了一份杂志或报纸， 那就不需要再去报摊查询新出版的刊物了。 出版社 （即应用中的 “发布者”） 会在刊物出版后 （甚至提前） 直接将最新一期寄送至你的邮箱中。</p><p>出版社负责维护订阅者列表， 了解订阅者对哪些刊物感兴趣。 当订阅者希望出版社停止寄送新一期的杂志时， 他们可随时从该列表中退出。</p><h2 id="观察者模式结构" tabindex="-1"><a class="header-anchor" href="#观察者模式结构"><span>观察者模式结构</span></a></h2><figure><img src="'+h+'" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><ol><li><strong>发布者</strong> （Publisher） 会向其他对象发送值得关注的事件。 事件会在发布者自身状态改变或执行特定行为后发生。 发布者中包含一个允许新订阅者加入和当前订阅者离开列表的订阅构架。</li><li>当新事件发生时， 发送者会遍历订阅列表并调用每个订阅者对象的通知方法。 该方法是在订阅者接口中声明的。</li><li><strong>订阅者</strong> （Subscriber） 接口声明了通知接口。 在绝大多数情况下， 该接口仅包含一个 update 更新方法。 该方法可以拥有多个参数， 使发布者能在更新时传递事件的详细信息。</li><li><strong>具体订阅者</strong> （Concrete Subscribers） 可以执行一些操作来回应发布者的通知。 所有具体订阅者类都实现了同样的接口， 因此发布者不需要与具体类相耦合。</li><li>订阅者通常需要一些上下文信息来正确地处理更新。 因此， 发布者通常会将一些上下文数据作为通知方法的参数进行传递。 发布者也可将自身作为参数进行传递， 使订阅者直接获取所需的数据。</li><li><strong>客户端</strong> （Client） 会分别创建发布者和订阅者对象， 然后为订阅者注册发布者更新。</li></ol><h2 id="伪代码" tabindex="-1"><a class="header-anchor" href="#伪代码"><span>伪代码</span></a></h2><p>在本例中， <strong>观察者</strong>模式允许文本编辑器对象将自身的状态改变通知给其他服务对象。</p><figure><img src="'+k+'" alt="将对象中发生的事件通知给其他对象。" tabindex="0" loading="lazy"><figcaption>将对象中发生的事件通知给其他对象。</figcaption></figure><p>订阅者列表是动态生成的： 对象可在运行时根据程序需要开始或停止监听通知。</p><p>在本实现中， 编辑器类自身并不维护订阅列表。 它将工作委派给专门从事此工作的一个特殊帮手对象。 你还可将该对象升级为中心化的事件分发器， 允许任何对象成为发布者。</p><p>只要发布者通过同样的接口与所有订阅者进行交互， 那么在程序中新增订阅者时就无需修改已有发布者类的代码。</p><div class="language-py line-numbers-mode" data-highlighter="shiki" data-ext="py" data-title="py" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 发布者基类包含订阅管理代码和通知方法。</span></span>\n<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">class</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> EventManager </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">is</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    private field listeners: </span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">hash</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> map</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> of event types </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">and</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> listeners</span></span>\n<span class="line"></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    method </span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">subscribe</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(eventType, listener) </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">is</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">        listeners.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">add</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(eventType, listener)</span></span>\n<span class="line"></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    method </span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">unsubscribe</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(eventType, listener) </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">is</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">        listeners.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">remove</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(eventType, listener)</span></span>\n<span class="line"></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    method </span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">notify</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(eventType, data) </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">is</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">        foreach</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (listener </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">in</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> listeners.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">of</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(eventType)) do</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">            listener.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">update</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(data)</span></span>\n<span class="line"></span>\n<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 具体发布者包含一些订阅者感兴趣的实际业务逻辑。我们可以从发布者基类中扩</span></span>\n<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 展出该类，但在实际情况下并不总能做到，因为具体发布者可能已经是子类了。</span></span>\n<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 在这种情况下，你可用组合来修补订阅逻辑，就像我们在这里做的一样。</span></span>\n<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">class</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> Editor </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">is</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    public field events: EventManager</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    private field </span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">file</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: File</span></span>\n<span class="line"></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    constructor </span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">Editor</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">() </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">is</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">        events </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> new </span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">EventManager</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">()</span></span>\n<span class="line"></span>\n<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    # 业务逻辑的方法可将变化通知给订阅者。</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    method </span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">openFile</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(path) </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">is</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">        this.file </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> new </span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">File</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(path)</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">        events.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">notify</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;open&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">file</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.name)</span></span>\n<span class="line"></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    method </span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">saveFile</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">() </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">is</span></span>\n<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">        file</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">write</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">()</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">        events.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">notify</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;save&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">file</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.name)</span></span>\n<span class="line"></span>\n<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    # ……</span></span>\n<span class="line"></span>\n<span class="line"></span>\n<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 这里是订阅者接口。如果你的编程语言支持函数类型，则可用一组函数来代替整</span></span>\n<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 个订阅者的层次结构。</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">interface EventListener </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">is</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    method </span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">update</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(filename)</span></span>\n<span class="line"></span>\n<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 具体订阅者会对其注册的发布者所发出的更新消息做出响应。</span></span>\n<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">class</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> LoggingListener implements EventListener </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">is</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    private field log: File</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    private field message: string</span></span>\n<span class="line"></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    constructor </span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">LoggingListener</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(log_filename, message) </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">is</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">        this.log </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> new </span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">File</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(log_filename)</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">        this.message </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> message</span></span>\n<span class="line"></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    method </span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">update</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(filename) </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">is</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">        log.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">write</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">replace</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">%s</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,filename,message))</span></span>\n<span class="line"></span>\n<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">class</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> EmailAlertsListener implements EventListener </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">is</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    private field email: string</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    private field message: string</span></span>\n<span class="line"></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    constructor </span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">EmailAlertsListener</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(email, message) </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">is</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">        this.email </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> email</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">        this.message </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> message</span></span>\n<span class="line"></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    method </span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">update</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(filename) </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">is</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">        system.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">email</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(email, </span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">replace</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">%s</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,filename,message))</span></span>\n<span class="line"></span>\n<span class="line"></span>\n<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 应用程序可在运行时配置发布者和订阅者。</span></span>\n<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">class</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> Application </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">is</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    method </span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">config</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">() </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">is</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">        editor </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> new </span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">Editor</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">()</span></span>\n<span class="line"></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">        logger </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> new </span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">LoggingListener</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span></span>\n<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">            &quot;/path/to/log.txt&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,</span></span>\n<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">            &quot;有人打开了文件：</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">%s</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span><span style="--shiki-light:#000000;--shiki-dark:#FFFFFF;">;</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">        editor.events.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">subscribe</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;open&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, logger)</span></span>\n<span class="line"></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">        emailAlerts </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> new </span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">EmailAlertsListener</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span></span>\n<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">            &quot;admin@example.com&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,</span></span>\n<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">            &quot;有人更改了文件：</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">%s</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">        editor.events.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">subscribe</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;save&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, emailAlerts)</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="观察者模式优缺点" tabindex="-1"><a class="header-anchor" href="#观察者模式优缺点"><span>观察者模式优缺点</span></a></h2><p>√ 开闭原则。 你无需修改发布者代码就能引入新的订阅者类 （如果是发布者接口则可轻松引入发布者类）。<br> √ 你可以在运行时建立对象之间的联系。<br> × 订阅者的通知顺序是随机的。</p><h2 id="与其他模式的关系" tabindex="-1"><a class="header-anchor" href="#与其他模式的关系"><span>与其他模式的关系</span></a></h2>',35)),(0,n.Lk)("ul",null,[(0,n.Lk)("li",null,[(0,n.Lk)("p",null,[(0,n.bF)(a,{to:"/posts/more-than-code/design-patterns/behavioral/chain-of-responsibility.html"},{default:(0,n.k6)((()=>i[0]||(i[0]=[(0,n.Lk)("strong",null,"责任链模式",-1)]))),_:1}),i[3]||(i[3]=(0,n.eW)("、 ")),(0,n.bF)(a,{to:"/posts/more-than-code/design-patterns/behavioral/command.html"},{default:(0,n.k6)((()=>i[1]||(i[1]=[(0,n.Lk)("strong",null,"命令模式",-1)]))),_:1}),i[4]||(i[4]=(0,n.eW)(" 、 ")),(0,n.bF)(a,{to:"/posts/more-than-code/design-patterns/behavioral/mediator.html"},{default:(0,n.k6)((()=>i[2]||(i[2]=[(0,n.Lk)("strong",null,"中介者模式",-1)]))),_:1}),i[5]||(i[5]=(0,n.eW)("和")),i[6]||(i[6]=(0,n.Lk)("strong",null,"观察者模式",-1)),i[7]||(i[7]=(0,n.eW)("用于处理请求发送者和接收者之间的不同连接方式："))]),i[8]||(i[8]=(0,n.Lk)("ul",null,[(0,n.Lk)("li",null,[(0,n.Lk)("em",null,"责任链"),(0,n.eW)(" 按照顺序将请求动态传递给一系列的潜在接收者， 直至其中一名接收者对请求进行处理。")]),(0,n.Lk)("li",null,[(0,n.Lk)("em",null,"命令"),(0,n.eW)(" 在发送者和请求者之间建立单向连接。")]),(0,n.Lk)("li",null,[(0,n.Lk)("em",null,"中介者"),(0,n.eW)(" 清除了发送者和请求者之间的直接连接， 强制它们通过一个中介对象进行间接沟通。")]),(0,n.Lk)("li",null,[(0,n.Lk)("em",null,"观察者"),(0,n.eW)(" 允许接收者动态地订阅或取消接收请求。")])],-1))]),(0,n.Lk)("li",null,[(0,n.Lk)("p",null,[(0,n.bF)(a,{to:"/posts/more-than-code/design-patterns/behavioral/mediator.html"},{default:(0,n.k6)((()=>i[9]||(i[9]=[(0,n.Lk)("strong",null,"中介者",-1)]))),_:1}),i[10]||(i[10]=(0,n.Fv)("和<strong>观察者</strong>之间的区别往往很难记住。 在大部分情况下， 你可以使用其中一种模式， 而有时可以同时使用。 让我们来看看如何做到这一点。<br><em>中介者</em> 的主要目标是消除一系列系统组件之间的相互依赖。 这些组件将依赖于同一个中介者对象。 <em>观察者</em> 的目标是在对象之间建立动态的单向连接， 使得部分对象可作为其他对象的附属发挥作用。<br> 有一种流行的中介者模式实现方式依赖于 <em>观察者</em>。 中介者对象担当发布者的角色， 其他组件则作为订阅者， 可以订阅中介者的事件或取消订阅。 当 <em>中介者</em> 以这种方式实现时， 它可能看上去与 * 观察者* 非常相似。<br> 当你感到疑惑时， 记住可以采用其他方式来实现中介者。 例如， 你可永久性地将所有组件链接到同一个中介者对象。 这种实现方式和 <em>观察者</em> 并不相同， 但这仍是一种中介者模式。<br> 假设有一个程序， 其所有的组件都变成了发布者， 它们之间可以相互建立动态连接。 这样程序中就没有中心化的中介者对象， 而只有一些分布式的观察者。",20))])])])])}]]),A=JSON.parse('{"path":"/posts/more-than-code/design-patterns/behavioral/observer.html","title":"观察者模式","lang":"zh-CN","frontmatter":{"title":"观察者模式","icon":"/assets/images/more-than-code/design-patterns/behavioral/observer/observer-mini.png","order":6,"category":["设计模式"],"description":"意图 观察者模式是一种行为设计模式， 允许你定义一种订阅机制， 可在对象事件发生时通知多个 “观察” 该对象的其他对象。 问题 假如你有两种类型的对象：​顾客和商店。顾客对某个特定品牌的产品非常感兴趣 （例如最新型号的 iPhone 手机）， 而该产品很快将会在商店里出售。 顾客可以每天来商店看看产品是否到货。 但如果商品尚未到货时， 绝大多数来到商店...","head":[["meta",{"property":"og:url","content":"https://mister-hope.github.io/blog/posts/more-than-code/design-patterns/behavioral/observer.html"}],["meta",{"property":"og:site_name","content":"大喵喜的技术杂货铺"}],["meta",{"property":"og:title","content":"观察者模式"}],["meta",{"property":"og:description","content":"意图 观察者模式是一种行为设计模式， 允许你定义一种订阅机制， 可在对象事件发生时通知多个 “观察” 该对象的其他对象。 问题 假如你有两种类型的对象：​顾客和商店。顾客对某个特定品牌的产品非常感兴趣 （例如最新型号的 iPhone 手机）， 而该产品很快将会在商店里出售。 顾客可以每天来商店看看产品是否到货。 但如果商品尚未到货时， 绝大多数来到商店..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2025-05-07T09:02:49.000Z"}],["meta",{"property":"article:modified_time","content":"2025-05-07T09:02:49.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"观察者模式\\",\\"image\\":[\\"\\"],\\"dateModified\\":\\"2025-05-07T09:02:49.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"Jianshu.Shi\\",\\"url\\":\\"https://mister-hope.com\\"}]}"]]},"headers":[{"level":2,"title":"意图","slug":"意图","link":"#意图","children":[]},{"level":2,"title":"问题","slug":"问题","link":"#问题","children":[]},{"level":2,"title":"解决方案","slug":"解决方案","link":"#解决方案","children":[]},{"level":2,"title":"真实世界类比","slug":"真实世界类比","link":"#真实世界类比","children":[]},{"level":2,"title":"观察者模式结构","slug":"观察者模式结构","link":"#观察者模式结构","children":[]},{"level":2,"title":"伪代码","slug":"伪代码","link":"#伪代码","children":[]},{"level":2,"title":"观察者模式优缺点","slug":"观察者模式优缺点","link":"#观察者模式优缺点","children":[]},{"level":2,"title":"与其他模式的关系","slug":"与其他模式的关系","link":"#与其他模式的关系","children":[]}],"git":{"createdTime":1741180358000,"updatedTime":1746608569000,"contributors":[{"name":"damiaoxi","username":"damiaoxi","email":"miaoxi1110@gmail.com","commits":2,"url":"https://github.com/damiaoxi"},{"name":"Jianshu","username":"Jianshu","email":"jianshu.shi@eisgroup.com","commits":4,"url":"https://github.com/Jianshu"}]},"readingTime":{"minutes":8.58,"words":2575},"localizedDate":"2025年3月5日","excerpt":"<h2>意图</h2>\\n<p>观察者模式是一种行为设计模式， 允许你定义一种订阅机制， 可在对象事件发生时通知多个 “观察” 该对象的其他对象。</p>\\n<figure><figcaption></figcaption></figure>\\n<h2>问题</h2>\\n<p>假如你有两种类型的对象：<code>​顾客</code>和<code>商店</code>。顾客对某个特定品牌的产品非常感兴趣 （例如最新型号的 iPhone 手机）， 而该产品很快将会在商店里出售。</p>\\n<p>顾客可以每天来商店看看产品是否到货。 但如果商品尚未到货时， 绝大多数来到商店的顾客都会空手而归。</p>\\n<figure><figcaption>前往商店和发送垃圾邮件</figcaption></figure>","autoDesc":true}')}}]);